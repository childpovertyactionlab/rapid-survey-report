"0","df %>% "
"0","  gather(key = ""answer"", value = ""value"", starts_with(""CPAL.BEN.001.a_"")) %>%"
"0","  group_by(answer) %>% "
"0","  summarise(percentage = (sum(value == 1 & CPAL.BEN.001 == 1, na.rm = T)/sum(CPAL.BEN.001 == 1, na.rm = T))) %>% "
"0","  arrange(desc(percentage)) %>%"
"0","  mutate("
"0","    color = case_when("
"0","      stringr::str_detect(answer, ""[1-3]$"") ~ palette_cpal_main[1],"
"0","      TRUE ~ palette_cpal_main[2]"
"0","    )"
"0","  ) %>%"
"0","  ggplot(aes(x = percentage, y = answer, fill = color)) +"
"0","  geom_bar(stat = ""identity"", width = 0.7) +"
"0","  geom_text(aes(label = ifelse(percentage > 0.15, scales::percent(percentage, scale = 100, accuracy = 0.1), """")), "
"0","          position = position_dodge(width=0.9), "
"0","          hjust = 1.1, "
"0","          size = 8, "
"0","          colour = ""white"") +"
"0","  geom_text(aes(label = ifelse(percentage <= 0.15, scales::percent(percentage, scale = 100, accuracy = 0.1), """")), "
"0","        position = position_dodge(width=0.9), "
"0","        hjust = -0.1, "
"0","        size = 8, "
"0","        colour = ""grey"") +"
"0","  scale_x_continuous(labels = scales::percent_format(scale = 100), limits = c(0,1)) +"
"0","  theme_minimal() +"
"0","  theme("
"0","    legend.position = ""none"","
"0","    title = element_blank(),"
"0","    axis.title = element_blank(),"
"0","    axis.text.y = element_text(size = 14)"
"0","  ) +"
"0","  scale_color_manual(values = palette_cpal_main) +"
"0","  scale_y_discrete(labels = function(x) {"
"0","    recodes <- c(""CPAL.BEN.001.a_1"" = ""The application was simple and easy to complete"","
"0","                 ""CPAL.BEN.001.a_2"" = ""I felt confident that I would receive help soon"","
"0","                 ""CPAL.BEN.001.a_3"" = ""I was able to access support in completing the application"" ,"
"0","                 ""CPAL.BEN.001.a_4"" = ""The process was frustrating"","
"0","                 ""CPAL.BEN.001.a_5"" = ""It was hard to know what was needed to complete the application"")"
"0","    return(stringr::str_wrap(recodes[x], width = 30))"
"0","  })"
"2","Warning: attributes are not identical across measure variables;
they will be dropped"
