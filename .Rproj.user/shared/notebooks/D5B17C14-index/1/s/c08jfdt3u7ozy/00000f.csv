"0",""
"0","df %>%"
"0","  filter(!is.na(POVERTYLine2023)) %>%"
"0","  mutate(POVERTYLine2023 = case_when("
"0","    POVERTYLine2023 == 1 ~ ""Under the poverty line"","
"0","    POVERTYLine2023 == 2 ~ ""Over the poverty line"","
"0","    TRUE ~ as.character(POVERTYLine2023)"
"0","  )) %>%"
"0","  count(POVERTYLine2023) %>%"
"0","  mutate(prop = n / sum(n)) %>%"
"0","  ggplot(aes(x = """", y = prop, fill = POVERTYLine2023)) +"
"0","  geom_bar(stat = ""identity"", width = 0.4) +"
"0","  geom_text(aes(label = scales::percent(prop, accuracy = 0.1), y = prop, size = 2), color = ""white"", position = position_stack(vjust = 0.5)) +"
"0","  geom_text(aes(label = POVERTYLine2023, y = prop, x = 1.3, size = 2), color = ""dimgrey"", position = position_stack(vjust = 0.5)) +"
"0","  labs(title = NULL,"
"0","       x = NULL,"
"0","       y = NULL) +"
"0","  coord_flip() +"
"0","  theme_minimal() +"
"0","  theme("
"0","    axis.text = element_blank(),"
"0","    axis.title = element_blank(),"
"0","    axis.ticks = element_blank(),"
"0","    panel.grid = element_blank(),"
"0","    legend.position = ""none"""
"0","  ) +"
"0","  scale_size_continuous(range = c(4, 6))"
