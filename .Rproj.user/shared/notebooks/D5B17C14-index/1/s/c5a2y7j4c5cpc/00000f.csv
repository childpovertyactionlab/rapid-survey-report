"0",""
"0","df %>%"
"0","  mutate(CPAL.EHQ.001 = factor("
"0","    case_when("
"0","      CPAL.EHQ.001 == 0 ~ ""Has decreased very much"","
"0","      CPAL.EHQ.001 == 1 ~ ""Has decreased somewhat"","
"0","      CPAL.EHQ.001 == 2 ~ ""Has stayed the same"","
"0","      CPAL.EHQ.001 == 3 ~ ""Has increased somewhat"","
"0","      CPAL.EHQ.001 == 4 ~ ""Has increased very much"","
"0","      TRUE ~ NA"
"0","    ),"
"0","    levels = c(""Has decreased very much"", "
"0","               ""Has decreased somewhat"", "
"0","               ""Has stayed the same"", "
"0","               ""Has increased somewhat"", "
"0","               ""Has increased very much"")"
"0","  )) %>%"
"0","  filter(!is.na(CPAL.EHQ.001)) %>%"
"0","  group_by(CPAL.EHQ.001) %>%"
"0","  tally() %>%"
"0","  mutate(prop = n/sum(n)) %>%"
"0","  ggplot(aes(x = prop, y = CPAL.EHQ.001, fill = CPAL.EHQ.001)) +"
"0","  geom_bar(stat = ""identity"", position = ""dodge"", width = 0.7) +"
"0","  geom_text(aes(label = ifelse(prop > 0.05, scales::percent(prop, scale = 100), """")), "
"0","            position = position_dodge(width=0.9), hjust = 1.1, size = 8, colour = ""white"") +"
"0","  geom_text(aes(label = ifelse(prop < 0.05, scales::percent(prop, scale = 100), """")), "
"0","          position = position_dodge(width=0.9), hjust = -0.1, size = 8, colour = ""grey"") +"
"0","  labs(fill = """") +"
"0","  theme_minimal() +"
"0","  theme("
"0","    legend.position = ""none"","
"0","    legend.key.size = unit(2, ""lines""), "
"0","    legend.text = element_text(size = 12),"
"0","    axis.title.x = element_blank(),"
"0","    axis.title.y = element_blank(),"
"0","    axis.text.y = element_text(size = 14),"
"0","    plot.background = element_rect(fill = ""transparent"", colour = NA),"
"0","    panel.background = element_rect(fill = ""transparent"", colour = NA),"
"0","    strip.background = element_rect(fill = ""transparent"", colour = NA),"
"0","    panel.grid.major.y = element_blank()"
"0","  ) +"
"0","  scale_fill_manual(values = colorRampPalette(c(palette_cpal_main[2], ""#ababab"", palette_cpal_main[1]))(5),"
"0","                    breaks = c(""Has decreased very much"","
"0","                               ""Has decreased somewhat"","
"0","                               ""Has stayed the same"", "
"0","                               ""Has increased somewhat"","
"0","                               ""Has increased very much"")"
"0","                    ) +"
"0","  scale_x_continuous(labels = scales::percent_format(scale = 100), expand = expansion(mult = c(0.1, 0)))"
"0",""
